<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <title>Ecommerce</title>
    <script type="text/javascript">
      var user = '{{request.user}}'
      function getToken(name) {
          let cookieValue = null;
          if (document.cookie && document.cookie !== '') {
              const cookies = document.cookie.split(';');
              for (let i = 0; i < cookies.length; i++) {
                  const cookie = cookies[i].trim();
                  // Does this cookie string begin with the name we want?
                  if (cookie.substring(0, name.length + 1) === (name + '=')) {
                      cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                      break;
                  }
              }
          }
          return cookieValue;
      }
      const csrftoken = getToken('csrftoken');

      function getCookie(name) {
          // Split cookie string and get all individual name=value pairs in an array
          var cookieArr = document.cookie.split(";");

          // Loop through the array elements
          for(var i = 0; i < cookieArr.length; i++) {
              var cookiePair = cookieArr[i].split("=");

              /* Removing whitespace at the beginning of the cookie name
              and compare it with the given string */
              if(name == cookiePair[0].trim()) {
                  // Decode the cookie value and return
                  return decodeURIComponent(cookiePair[1]);
              }
          }

          // Return null if not found
          return null;
		}
    var cart = JSON.parse(getCookie('cart'))
    if(cart == undefined){
      cart = {}
      console.log('Cart was created!')
      //Setting the cookie
      document.cookie = "cart=" + JSON.stringify(cart) + ";domain=;path=/"
    }
    console.log('Cart: ', cart)
    </script>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark dark">
        <a class="navbar-brand" href="{% url 'store' %}">Ecom</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
                <a class="nav-link" href="{% url 'store' %}">Store<span class="sr-only">(current)</span></a>
            </li>
          </ul>
          <div class="form-inline my-2 my-lg-0">
            {% if user.is_authenticated %}
            <a class="text-white mr-3" href="#">Hey, {{ user.username }}</a>
            <a href="{% url 'logout_request' %}" class="btn btn-warning">Logout</a>  
            {% else %}
            <a href="{% url 'login_request' %}" class="btn btn-danger">Login</a> 
            {% endif %}
            <a href="{% url 'cart' %}">
            <img  id="cart-icon" src="{% static 'images/cart.png' %}"> </a>
            <p id="cart-total">{{cartItems}}</p>
           </div>
        </div>
      </nav>
    <div class="container">
        <br>
        {% block content %}


        {% endblock %}
     </div>
     <br>
     <footer class="footer bg-dark text-center ">
      <div class="container p-4 pb-0">
          <div class="row">             
              <div class="col col-sm">
                  <h5 >My Address</h5>
                  <address>
                      JSSATE BOYS HOSTEL<br>
                      Reflex Housing Layout, Hemmigepura Ward,<br>
                      RR Nagar, Bengaluru, Karnataka<br> 560098
                      <br>
                      <i class='fas fa-mobile fa-lg'></i>: 6266454164<br>
                      <i class='fas fa-envelope fa-lg'></i>: 
                    <a style="color: black;" href="mailto:sundeepkumarsingh0@gmail.com">sundeepkumarsingh0@gmail.com</a>
                 </address>
              </div>
              <div class="col-12 col-sm align-self-center">
                  <div class="text-center">
                      <!-- Facebook -->
                          <a
                          class="btn text-white btn-floating m-1"
                          style="background-color: #3b5998; border-radius: 50%;"
                          href="#!"
                          role="button"
                          ><i class="fab fa-facebook-f"></i
                        ></a>

                        <!-- Twitter -->
                        <a
                          class="btn text-white btn-floating m-1"
                          style="background-color: #55acee; border-radius: 50%;"
                          href="#!"
                          role="button"
                          ><i class="fab fa-twitter"></i
                        ></a>

                        <!-- Google -->
                        <a
                          class="btn text-white btn-floating m-1"
                          style="background-color: #dd4b39; border-radius: 50%;"
                          href="#!"
                          role="button"
                          ><i class="fab fa-google"></i
                        ></a>

                        <!-- Instagram -->
                        <a
                          class="btn text-white btn-floating m-1"
                          style="background-color: #ac2bac; border-radius: 50%;"
                          href="#!"
                          role="button"
                          ><i class="fab fa-instagram"></i
                        ></a>

                        <!-- Linkedin -->
                        <a
                          class="btn text-white btn-floating m-1"
                          style="background-color: #0082ca; border-radius: 50%;"
                          href="#!"
                          role="button"
                          ><i class="fab fa-linkedin-in"></i
                        ></a>
                        <!-- Github -->
                        <a
                          class="btn text-white  btn-floating m-1"
                          style="background-color: #333333; border-radius: 50%;"
                          href="#!"
                          role="button"
                          ><i class="fab fa-github"></i
                        ></a>
                  </div>
              </div>
         </div>
         <div class="row justify-content-center">             
              <div class="col-auto">
                  <p>Â©Made By Sundeep Kumar Singh</p>
              </div>
         </div>
      </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  <script type="text/javascript" src="{% static 'js/cart.js' %}"></script>
</body>
</html>